---
title: linux
date: 2016-11-24 21:20:31
tags:
- linux
comments: true
categories:
- 学习路线
---

这篇算是linux学习笔记草稿吧，内容有些乱，等学习完以后再对内容进行整理。感谢简书作者：谢恩铭老师写的Linux探索之旅系列教材。

***

>## 指令:

TAB键：补全
Ctrl+R键：查找使用过的指令
history：列出之前使用过的所有命令
Ctrl+L键：清屏
Ctrl+D键：给终端传递EOF文件结束符。在命令行什么不输入的情况下，关闭当前终端。
ls -lh 文件以K为单位，适合阅读的方式列出文件列表信息
ls -lt 按文件最近一次修改时间排序
ls -lath 叠加
du: 显示目录包含文件大小，-h 以k,m,g的形式显示文件大小。-a 显示目录和文件的大小.-s 显示总计大小
df -h: 目录容量
pwd: 当前所在目录
which: 获取命令的可执行文件的位置
cat: 一次性显示文件的所有内容，适合小文件,-n 显示行号。
less: 分页显示文件内容,空格键：下一页。回车键：读取一行，d键：前进半页，b键：后退一页，y键：后退一行，u键：后退半页，q键：停止读取文件.=号：显示所在文件中的位置.h键：显示帮助文档。/：搜索模式n键跳到下一个符合项目，N键跳到上一条（shift+n），可以使用正则表达式
head: 显示文件头,-n 指定显示行数，比如 -n 5,显示文件头5行
tail:显示文件尾，-n  同head,-f 实时跟踪文件的更新,默认每1秒检查，可用 -s 参数修改，例如: -s 4 每隔4秒检查一次
touch: 创建一个空白文件,创建多个文件中间加空格，文件名含空格需要加双引号
mkdir: 创建一个目录，创建多个目录同touch，-p 参数可创建递归目录结构，比如mkdir -p one/two/three
cp: 拷贝文件或目录 cp new_file new_file_copy。 -R 参数，拷贝目录。
mv：移动、重命名文件（目录）mv new_file_2 one ,移动文件到one目录，相当于剪切。均可使用通配符,mv new_file renamed_file  重命名。
rm: 删除文件和目录，删除多个文件，之间加空格。-i参数，向用户确认是否删除，-f参数,不询问强制删除，-r参数，递归删除。
ln: 创建链接，链接分硬链接和软链接。
* 硬链接原理：使链接的两个文件共享同样的文件内容，一旦文件1和文件2之间有了硬链接，那么修改文件1或文件2，其实修改的是相同的一块内容。缺陷：只能创建指向文件的硬链接，不能创建指向目录的硬链接。对于目录的链接，一般使用软链接。
删除文件1，对文件2没有任何影响，同样，删除2对1也没有任何影响，删除任意一方的文件，共同指向的文件内容并不会从硬盘上被删除。
只有即删除文件1又删除文件2，它们共同指向的文件内容才会消失。
ls -i （-i参数可以显示文件的inode）

` ln file1 file2 `

* 软链接，像windows下的快捷方式，创建软链接需要加上-s参数

` ln -s file1 file2 `
如果删除file2，没什么大不了，file1不会受影响。如果删除file1，那么file2会变成“死链接”，因为指向的文件不见了

软链接可以指向目录。

>## 文件目录

bin: 表示“二进制文件”，可执行文件是二进制，包含了会被所有用户使用的可执行程序
boot: 表示“启动”。包含与Linux启动密切相关的文件。
dev: 表示“设备”，包含外设。
etc: 包含系统的配置文件。
home: 表示“家”，用户的私人目录。root不跟普通用户住在一起。
lib: 表示“库”，包含被程序所调用的库文件。
media: 表示“媒体”，当一个可移动的外设比如U盘插入电脑时，可通过media子目录来访问这些外设中的内容。
mnt: 表示“挂载”，一般用于临时挂载一些装置。
opt: 表示“可选的应用软件包”。用于安装多数第三方软件和插件。
root: 表示“根”，root的主目录。
sbin: 表示“系统二进制文件”，比起bin目录多了一个前缀system,所以包含的是系统级的重要可执行程序。
srv: 表示“服务”，包含一些网络服务启动之后所需要取用的数据。
tmp: 表示“临时的”，普通用户和程序存放临时文件的地方。
usr: 表示“操作系统软件资源”。最庞大的目录之一，类似windows中的c:\windows和c:\program Files 这两个文件夹的集合。里面安装了大部分用户要调用的程序。
var: 表示“动态的,可变的”，通常包含程序的数据，比如log文件，记录电脑中发生了什么事。

* 终端默认颜色标注
蓝色：目录
绿色：可执行文件
红色：压缩文件
浅蓝色：链接文件
灰色：其他文件

如果终端没有标明颜色，可以通过 ls --color=auto 来开启颜色标注。
ls --color=none //关闭颜色标注

>## 用户和权限

sudo: 暂时成为root,替换用户来执行的意思.
`sudo 只有root才可以运行的命令`
sudo su: 一直成为root用户,exit命令可以退出root用户，重回个人用户身份。
其他版本linux命令:
`su - ` 直接定位到root的家目录。

adduser: 添加新用户。centos版本命令:useradd
passwd: 修改密码 
deluser: 删除用户,--remove-home,参数删除用户的家目录。centos版本命令：userdel 
其他linux发行版，添加删除用户的命令是:useradd 和 userdel 命令，而且添加用户之后，默认情况下，该账号是暂时被封锁的，无法登陆，须用passwd命令给用户设置密码之后才可以使用。

* 群组管理
创建用户时，默认会创建一个和它的用户名一样的群组，并且把用户划归到这个群组。

addgroup: 创建群组 `addgroup 群组名` centos版本命令：groupadd

usermod: 修改用户账号。-l参数：重命名用户，但home目录中的用户家目录名不会改变，需要手动修改。-g参数：修改用户所在群组。-G参数：添加多个群组`usermod -G 群组1，群组2，群组3 用户` -a参数：追加群组，并不从其他组中删除此用户。a参数只能和G参数一起使用。`usermod -aG 新群组 用户`,这样保留用户的老群组并追加到新组中。
**切记：** 追加群组的时候，一定要用大写的G这个参数，不能用小写的g这个参数，即使只追加一个群组。

* delgroup：删除群组
`delgroup 群组名`

**注意：** addgroup和delgroup命令只是Debian一族才有的命令。其他的Linux发行版，一般添加用户和删除用户群组的命令是:groupadd和groupdel

* 修改文件的所有者和群组
只有root用户可以修改一个文件的所有者和群组

chown: 改变文件的所有者
`chown 新用户名 文件名`
`chown 用户:群组 文件` \\改变文件的用户和群组
-R参数：递归设置子目录和子文件


chgrp: 改变文件的群组
`chgrp 新群组 文件名`

chmod：修改访问权限

d:目录 l：链接 r:读 w:写，修改 x:执行，运行
x在一个目录上，表示这个目录可以被读。
如果有w权限，表面也有删除此文件的权限
root用户拥有所有的权限，它可以读、写、运行任意文件


一个文件或目录划分显示：

| 目录 | 所有者 | 群组用户 | 其他用户 |
| --- | --- | --- | --- |
| d | rwx | rwx | rwx |

只要是文件的所有者，就可以用chmod来修改文件的访问权限。

用数字来分配权限：
r: 4
w: 2
x: 1
`chmod 600 文件`
用字母分配:
u: 所有者
g: 群组
o: 其他用户
+: 添加权限
-：去除权限
=：分配权限
`chmod u+rx 文件`\\给所有者增加读和运行权限
`chmod g+w 文件`\\给群组增加写权限
`chmod o-w 文件` \\给其他用户去除写权限
`chmod u+rwx,g=r,o=- 文件名`\\给所有者分配所有权限，群组读权限，不能写或执行，其他用户没有任何权限。
-R参数：递归地修改访问权限

>## 软件安装

软件包管理包括了依赖关系的管理

软件包不需要我们通过搜索引擎来找到并下载，几乎所有的.deb软件包都存在相同地方，称为软件仓库，repository

教程上面主要讲解的是ubuntu系统，而我学习的是centos,还是有些出入的，软件安装内容不再抄录。

>## 查找文件

locate: 快速查找 centos没有这个命令
find: 深入查找
`find 《何处》《何物》《做什么》`
《何物》是必须指定的，也就是要查找什么
* 何处：指定在哪个目录中查找，假如没有给出这个参数，那么会在当前目录及其子目录中查找。
* 何物：也就是要查找什么。可以根据文件的名字、大小、最近访问时间来查找等等。
* 做什么：找到文件后，可以对每个文件做一定的操作。称为“后续处理”

* 根据文件名查找：
`find -name "文件名"`
-name参数指定了文件名字，用双引号括起来，不加双引号或者用单引号也是可以的。
文件名可以使用通配符。

* 根据文件大小查找：
`find /var -size +10M`  
查找var目录下，大小超过10M的文件。-size参数：尺寸、大小的意思。
如果要查找小于指定大小的文件，可以使用减少，例如：`-size -50K`

* 根据文件的最近访问时间查找
`find -name "文件名" -atime -7`
-atime参数后面紧跟的-7，表示7天之内，减号的作用是表示小于

* 仅查找目录或文件
-type 参数指定查找的文件类型。
-type d: 只查找目录类型。d是directory的首字母，表示“目录”
-type f: 只查找文件类型。f是file的首字母，表示“文件”
如果不使用-type参数指定类型，那么find命令默认是查找目录和文件。

* 格式化打印查找结果
-printf参数：表示“格式化打印”
`find 文件名 -printf "%p - %u\n"`
%p: 文件名
-: 就是一个短横
%u: 文件的所有者
\n： 换行

* 删除查找到的文件
-delete 参数：删除当前目录及子目录下查找到的文件，而且不会有确认提示，慎用该参数。

* 调用命令
-exec 参数：可以后面接一个命令，对每个查找到的文件进行操作。是execute的缩写，是英语“执行”的意思
比如对查找的文件访问权限都设为600：`-exec chmod 600 {} \;`
这个操作不必用双引号括起来
{} 会用查找到的每个文件来替换
\; 是必须的结尾。
如果-exec参数换成-ok参数，则对每一个查找到的文件都做确认提示。

>## 数据处理


* grep命令：筛选数据
意思是全局搜索一个正则表达式，并且打印，简单来说，就是在文件中查找关键字，并且显示关键字所在的行。

`grep text file`

text代表搜索的文本，file代表供搜过的文件
例如: `grep alias .bashrc` 搜索home目录.bashrc文本中包含alias的行
如果搜索的字符串中含有空格，则加上双引号
-i 参数：忽略大小写，默认情况下，grep是区分大小写的.
-n 参数：显示行号
-v 参数：只显示文本不在的行
-r 参数：在所有子目录和子文件中查找,file需要换成目录
`grep -r "hello world home/"`
home后面那个(/)不是必须的。

* grep的高级用法：配合正则表达式

-E 参数：使用正则表达式

* sort命令：为文件排序
`sort 文件`
将文件中的行按照首字母的英文字典顺序进行排列，不区分大小写
-o 参数：将排序后的内容写入新文件
`sort -o 排序后文件2 文件1`
-r 参数：倒序排列
-R 参数：随机排序
-n 参数：对数字排序

*  wc命令： 文件的统计
`wc 文件`
按顺序显示出三个数字，分别表示：行数、单词数和字节数
-l 参数： 统计行数
-w 参数： 统计单词数
-c 参数： 统计字节数
-m 参数： 统计字符数

* uniq命令： 删除文件中的重复内容。它只能将连续的重复行变为一行。
该命令并不会改变原文件的内容，只会把处理后的内容显示出来。如果想将处理后的内容存储到一个新文件中，可以使用如下方法：
`uniq 文件 新文件名`
-c 参数： 统计重复的行数
-d 参数： 只显示重复行的值

* cut命令：剪切文件的一部分内容
-c 参数： 根据字符数来剪切
比如，每一行只保留第2至第4个字符，可以这样做：
`cut -c 2-4 文件`


>## 流、管道、重定向，三管齐下

命令的输出可以有三个去向：
* 终端
* 文件
* 其他命令的输入

### >和>>:重定向到文件
* cut命令进阶：根据分隔符来剪切
CSV格式是逗号分隔值：有时也称为字符分隔值，因为分隔字符也可以不是逗号，其文件以纯文本形式存储表格数据（数字和文本）。纯文本意外着该文件是一个字符序列，不含必须像二进制数字那样被解读的数据。
csv文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。
通常，所有记录都有完全相同的字段序列。
-d参数：用于指定用什么分隔符（比如逗号，分号，双引号等等）
-f参数：表示剪切下用分隔符分隔的哪一块或哪几块区域。
```
cut -d , -f 1 文件   //逗号分隔符，分隔第一块
cut -d , -f 1,2 文件 // 分隔第1，2块
cut -d , -f 2- 文件  //分隔2块以后所有内容

```
### >:重定向到新的文件


(未完待续)
